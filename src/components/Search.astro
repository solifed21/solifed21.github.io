---
---

<div class="search-wrapper">
	<input type="text" id="search-input" placeholder="검색..." autocomplete="off" />
	<div id="search-results"></div>
</div>

<script>
	const posts = await fetch('/search.json').then(r => r.json());
	const input = document.getElementById('search-input') as HTMLInputElement;
	const results = document.getElementById('search-results')!;

	input.addEventListener('input', () => {
		const q = input.value.toLowerCase().trim();
		if (!q) { results.innerHTML = ''; return; }
		const matches = posts.filter((p: any) =>
			p.title.toLowerCase().includes(q) || p.description.toLowerCase().includes(q)
		).slice(0, 5);
		results.innerHTML = matches.length
			? matches.map((p: any) => `<a href="${p.url}">${p.title}</a>`).join('')
			: '<span class="no-result">결과 없음</span>';
	});

	document.addEventListener('click', (e) => {
		if (!(e.target as Element).closest('.search-wrapper')) results.innerHTML = '';
	});
</script>

<style>
	.search-wrapper {
		position: relative;
	}
	#search-input {
		padding: 0.5em 0.75em;
		border: 1px solid var(--border-color);
		border-radius: 6px;
		background: var(--bg-primary);
		color: var(--text-primary);
		width: 200px;
		font-size: 0.9em;
		transition: border-color 0.15s, width 0.2s;
	}
	#search-input:focus {
		outline: none;
		border-color: var(--accent);
		width: 240px;
	}
	#search-results {
		position: absolute;
		top: calc(100% + 6px);
		right: 0;
		width: 320px;
		max-height: 400px;
		overflow-y: auto;
		background: var(--bg-card);
		border: 1px solid var(--border-color);
		border-radius: 8px;
		box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
		z-index: 200;
	}
	#search-results:empty { display: none; }
	#search-results a, #search-results .no-result {
		display: block;
		padding: 0.75em 1em;
		font-size: 0.9em;
		color: var(--text-primary);
		border-bottom: 1px solid var(--border-color);
	}
	#search-results a:last-child { border-bottom: none; }
	#search-results a:hover { background: var(--bg-secondary); }
	.no-result { color: var(--text-secondary); }
	@media (max-width: 720px) {
		#search-input { width: 140px; }
		#search-input:focus { width: 180px; }
		#search-results { width: 280px; }
	}
</style>
